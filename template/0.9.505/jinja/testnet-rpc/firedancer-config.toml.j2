name = "solv"
user = "solv"
scratch_directory = "/home/{user}"
dynamic_port_range = "{{ dynamic_port_range | default("8900-8925") }}"

[log]
    path = "/home/solv/solana-validator.log"
    colorize = "auto"
    level_logfile = "INFO"
    level_stderr = "NOTICE"
    level_flush = "WARNING"

[rpc]
    port = {{ rpc_port | default(8899) }}
    {% if rpc_type == 'Geyser gRPC' %}
    # Geyser gRPC configuration
    full_api = true
    private = false
    transaction_history =  {{ (transaction_history | default(true) | to_json ) }}
    extended_tx_metadata_storage = {{ extended_tx_metadata_storage | default(true) | to_json }}
    pubsub_enable_block_subscription = {{ pubsub_enable_block_subscription | default(true) | to_json }}
    pubsub_enable_vote_subscription = {{ pubsub_enable_vote_subscription | default(true) | to_json }}
    bigtable_ledger_storage = {{ bigtable_ledger_storage | default(false) | string | lower }}
    {% elif rpc_type == 'SendTx RPC' %}
    # SendTx RPC configuration (minimal for transaction sending)
    full_api = true
    private = false
    transaction_history = {{ transaction_history | default(false) | string | lower }}
    extended_tx_metadata_storage = {{ extended_tx_metadata_storage | default(false) | string | lower }}
    pubsub_enable_block_subscription = {{ pubsub_enable_block_subscription | default(false) | string | lower }}
    pubsub_enable_vote_subscription = {{ pubsub_enable_vote_subscription | default(false) | string | lower }}
    bigtable_ledger_storage = {{ bigtable_ledger_storage | default(false) | string | lower }}
    {% elif rpc_type == 'Index RPC' %}
    # Index RPC configuration (full indexing)
    full_api = true
    private = false
    transaction_history = {{ transaction_history | default(true) | to_json }}
    extended_tx_metadata_storage = {{ extended_tx_metadata_storage | default(true) | to_json }}
    pubsub_enable_block_subscription = {{ pubsub_enable_block_subscription | default(true) | to_json }}
    pubsub_enable_vote_subscription = {{ pubsub_enable_vote_subscription | default(true) | to_json }}
    bigtable_ledger_storage = {{ bigtable_ledger_storage | default(false) | string | lower }}
    {% elif rpc_type == 'Index RPC + gRPC' %}
    # Index RPC + gRPC configuration (full features)
    full_api = true
    private = false
    transaction_history = {{ transaction_history | default(true) | to_json }}
    extended_tx_metadata_storage = {{ extended_tx_metadata_storage | default(true) | to_json }}
    pubsub_enable_block_subscription = {{ pubsub_enable_block_subscription | default(true) | to_json }}
    pubsub_enable_vote_subscription = {{ pubsub_enable_vote_subscription | default(true) | to_json }}
    bigtable_ledger_storage = {{ bigtable_ledger_storage | default(false) | string | lower }}
    {% else %}
    # Default configuration
    full_api = {{ full_api | default(false) | string | lower }}
    private = false
    transaction_history = {{ transaction_history | default(false) | string | lower }}
    extended_tx_metadata_storage = {{ extended_tx_metadata_storage | default(false) | string | lower }}
    pubsub_enable_block_subscription = {{ pubsub_enable_block_subscription | default(true) | to_json }}
    pubsub_enable_vote_subscription = {{ pubsub_enable_vote_subscription | default(true) | to_json }}
    bigtable_ledger_storage = {{ bigtable_ledger_storage | default(false) | string | lower }}
    {% endif %}

[reporting]
    solana_metrics_config = "host=https://metrics.solana.com:8086,db=tds,u=testnet_write,p=c4fa841aa918bf8274e3e2a44d77568d9861b3ea"

[ledger]
    path = "/mnt/ledger"
    accounts_path = "/mnt/accounts"
    {% if rpc_type == 'Geyser gRPC' %}
    # Minimal ledger for Geyser gRPC
    limit_size = {{ limit_ledger_size | default(50_000_000) }}
    account_indexes = []
    account_index_exclude_keys = []
    {% elif rpc_type == 'SendTx RPC' %}
    # Minimal ledger for SendTx RPC
    limit_size = {{ limit_ledger_size | default(30_000_000) }}
    account_indexes = []
    account_index_exclude_keys = []
    {% elif rpc_type == 'Index RPC' %}
    # Full indexing for Index RPC
    limit_size = {{ limit_ledger_size | default(200_000_000) }}
    account_indexes = {{ account_indexes | default('["program-id", "spl-token-mint", "spl-token-owner"]') }}
    account_index_exclude_keys = {{ account_index_exclude_keys | default("[]") }}
    {% elif rpc_type == 'Index RPC + gRPC' %}
    # Full indexing for Index RPC + gRPC
    limit_size = {{ limit_ledger_size | default(200_000_000) }}
    account_indexes = {{ account_indexes | default('["program-id", "spl-token-mint", "spl-token-owner"]') }}
    account_index_exclude_keys = {{ account_index_exclude_keys | default("[]") }}
    {% else %}
    # Default configuration
    limit_size = {{ limit_ledger_size | default(100_000_000) }}
    account_indexes = {{ account_indexes | default("[]") }}
    account_index_exclude_keys = {{ account_index_exclude_keys | default("[]") }}
    {% endif %}
    snapshot_archive_format = "zstd"
    require_tower = false

[snapshots]
    incremental_snapshots = true
    full_snapshot_interval_slots = 25000
    incremental_snapshot_interval_slots = 100
    path = "/mnt/snapshot"

[gossip]
    entrypoints = [
      "entrypoint.testnet.solana.com:8001",
      "entrypoint2.testnet.solana.com:8001",
      "entrypoint3.testnet.solana.com:8001",
    ]
    port_check = false

[consensus]
    identity_path = "/home/solv/identity.json"
    snapshot_fetch = true
    genesis_fetch = true
    expected_genesis_hash = "4uhcVJyU9pJkvQyS88uRDiswHXSCkY3zQawwpjk2NsNY"
    expected_bank_hash = "4NuNyboT36pwwGJvMPZLreFqYpkbpBjX82nkt4AkJ9QT"
    expected_shred_version = 41708

[hugetlbfs]
    mount_path = "/mnt"
    max_page_size = "huge"

[layout]
     affinity = "auto"
     agave_affinity = "auto"
     verify_tile_count = 1
     bank_tile_count = 1

[tiles.gui]
    enabled = true
    gui_listen_port = 6001
    gui_listen_address = "0.0.0.0"

[tiles.metric]
    prometheus_listen_address = "0.0.0.0"
    prometheus_listen_port = 7999

{% if rpc_type == 'Geyser gRPC' or rpc_type == 'Index RPC + gRPC' %}
# Geyser gRPC Plugin Configuration
{% endif %}

{% if validator_type == 'firedancer-jito' %}
# Jito Firedancer Configuration
[tiles.bundle]
    enabled = true
    url = "{{ block_engine_url | default("https://ny.testnet.block-engine.jito.wtf", true) }}"
    tip_distribution_program_addr = "F2Zu7QZiTYUhPd7u9ukRVwxh7B71oA3NMJcHuCHc29P2"
    tip_payment_program_addr = "GJHtFqM9agxPmkeKjHny6qiRKrXZALvvFGiKf11QE7hy"
    tip_distribution_authority = "GZctHpWXmsZC1YHACTGGcHhYxjdRqQvTpYkb9LMvxDib"
    commission_bps = {{ commission_bps | default(1000, true) }}
{% endif %}

